# SX-Set - Minecraft装备套装系统

SX-Set 是一个基于 SX-Attribute 的 Minecraft 服务器插件，用于实现强大而灵活的装备套装系统。通过简单的配置，服务器管理员可以创建各种具有不同属性加成的装备套装，并为玩家提供直观的套装状态显示。

## ✨ 功能特点

### 🎯 核心功能
- **多套装支持**: 支持同时装备多个不同套装，效果可叠加
- **灵活件数配置**: 支持任意件数套装（2件套、3件套、4件套、5件套等）
- **动态属性加成**: 根据装备件数自动激活对应的属性效果
- **智能套装识别**: 通过物品描述（lore）自动识别套装部件
- **完美API集成**: 与 SX-Attribute 插件深度集成，属性系统统一

### 🔄 实时更新功能
- **LORE状态显示**: 装备描述实时显示套装激活状态，如 `(0/4)` → `(2/4)` → `(4/4)`
- **动态件数计算**: 根据配置自动计算套装总件数，无需硬编码
- **即时响应**: 装备变化时立即更新所有相关物品的状态显示
- **多场景触发**: 支持玩家加入、装备变化、背包操作等多种触发方式

## 📋 系统要求

- **Minecraft版本**: 1.20+ (推荐1.20.1+)
- **必需依赖**: SX-Attribute 插件
- **Java版本**: Java 17 或更高版本
- **服务端**: Paper/Spigot/Bukkit

## 🚀 安装方法

1. **安装依赖**: 确保服务器已正确安装并配置 SX-Attribute 插件
2. **下载插件**: 获取最新版本的 sx-set.jar 文件
3. **部署插件**: 将文件放入服务器的 `plugins` 目录
4. **启动服务器**: 重启服务器或使用 `/reload` 命令重载插件
5. **验证安装**: 检查控制台输出 "SX-Set 套装插件已启用！" 消息

## ⚙️ 配置说明

### 📁 文件结构
```
plugins/SX-Set/
├── config.yml          # 主配置文件
└── sets/               # 套装配置目录
    ├── example.yml     # 示例套装配置
    ├── frost_warrior.yml # 冰霜战士套装
    └── custom_sets.yml # 自定义套装配置
```

### 🛡️ 套装配置

套装配置文件存放在 `plugins/SX-Set/sets/` 目录下，使用 YAML 格式。支持在单个文件中配置多个套装，也可以分文件管理。

#### 基本配置结构
```yaml
套装ID:
  name: "套装显示名称"
  pieces:
    helmet: "头盔识别关键字"
    chestplate: "胸甲识别关键字"
    leggings: "护腿识别关键字"
    boots: "靴子识别关键字"
    # 可以添加更多部件或减少部件
  attributes:
    2:  # 2件套激活效果
      - "属性名称: 数值"
      - "属性名称: 数值"
    4:  # 4件套激活效果
      - "属性名称: 数值"
      - "属性名称: 数值"
      - "属性名称: 数值"
```

#### 灵活件数支持
插件支持任意件数的套装配置：
- **2件套**: 只需配置头盔和胸甲
- **3件套**: 配置头盔、胸甲、护腿
- **4件套**: 配置全套装备
- **5件套及以上**: 可添加武器、饰品等更多部件

### 📝 配置示例

#### 4件套装示例
```yaml
dragon_set:
  name: "龙之套装"
  pieces:
    helmet: "§c[龙之头盔]"
    chestplate: "§c[龙之胸甲]"
    leggings: "§c[龙之护腿]"
    boots: "§c[龙之靴子]"
  attributes:
    2:  # 2件套效果
      - "物理伤害: 10"
      - "暴击几率: 5%"
    4:  # 4件套效果
      - "物理伤害: 25"
      - "暴击几率: 15%"
      - "生命上限: 200"
```

#### 3件套装示例
```yaml
mage_set:
  name: "法师套装"
  pieces:
    helmet: "§9[法师帽]"
    chestplate: "§9[法师袍]"
    leggings: "§9[法师裤]"
  attributes:
    2:  # 2件套效果
      - "魔法伤害: 15"
      - "魔法值上限: 100"
    3:  # 3件套效果
      - "魔法伤害: 30"
      - "魔法值上限: 200"
      - "魔法恢复: 10"
```

#### 复杂套装配置示例
```yaml
frost_warrior_set:
  name: "冰霜战士套装"
  pieces:
    helmet: "冰霜战士头盔"
    chestplate: "冰霜战士胸甲"
    leggings: "冰霜战士护腿"
    boots: "冰霜战士靴子"
  attributes:
    2:
      - "生命上限: 200"
      - "物理防御: 30"
      - "冰霜抗性: 15%"
    4:
      - "生命上限: 500"
      - "物理防御: 60"
      - "冰霜抗性: 40%"
      - "移速增幅: 20%"
      - "技能冷却: 15%"
```

## 🎮 使用方法

### 🔧 创建新套装

1. **创建配置文件**: 在 `plugins/SX-Set/sets/` 目录下创建新的 YAML 文件
2. **编写套装配置**: 按照上述格式配置套装信息
3. **重载插件**: 使用 `/reload` 命令或重启服务器
4. **创建装备物品**: 确保物品lore中包含配置的识别关键字
5. **测试验证**: 装备物品验证套装效果和状态显示

### 🔍 套装识别机制

#### 识别原理
- **关键字匹配**: 插件通过物品lore中的关键字识别套装部件
- **精确匹配**: 关键字必须完全匹配（支持颜色代码转换）
- **智能识别**: 自动处理 `§` 和 `&` 颜色代码格式

#### 状态显示格式
- **未装备**: `套装名称 (0/4)` - 没有装备任何套装件
- **部分装备**: `套装名称 (2/4)` - 装备了2件，共4件套装
- **完整装备**: `套装名称 (4/4)` - 装备了完整套装
- **动态更新**: 装备变化时实时更新所有相关物品

### ⚡ 属性效果系统

#### 效果激活机制
- **阈值激活**: 达到配置的件数要求时自动激活对应效果
- **累积效果**: 高件数效果包含低件数的所有效果
- **即时生效**: 装备变化时立即应用或移除效果
- **多套装叠加**: 不同套装的效果可以同时存在并叠加

#### 属性兼容性
- **SX-Attribute集成**: 所有属性必须符合SX-Attribute插件格式
- **标准属性**: 支持生命、攻击、防御、暴击等标准属性
- **特殊效果**: 支持抗性、冷却、移速等特殊属性
- **自定义属性**: 支持SX-Attribute插件的所有自定义属性

## 🔄 实时更新功能详解

### 📱 LORE状态显示

#### 显示效果示例
```
装备前:
§c[龙之头盔]
§6品质等级: §c传说
§6物品类型: 头盔
§c龙之套装 (0/4)

装备2件后:
§c[龙之头盔]
§6品质等级: §c传说
§6物品类型: 头盔
§c龙之套装 (2/4)

装备全套后:
§c[龙之头盔]
§6品质等级: §c传说
§6物品类型: 头盔
§c龙之套装 (4/4)
```

#### 更新触发时机
- **玩家加入服务器**: 自动更新所有装备的套装状态
- **装备栏变化**: 装备或卸下套装件时立即更新
- **背包操作**: 在背包中移动装备时实时响应
- **物品切换**: 切换手持物品时同步更新状态

### ⚙️ 主配置文件 (config.yml)

```yaml
# SX-Set Configuration

# 套装文件夹路径
sets-folder: "sets"

# 调试模式开关
debug: false

# 是否启用自动重载
auto-reload: true

# 套装检查间隔（秒）
check-interval: 1
```

## ⚠️ 注意事项

### 🔧 配置要求
1. **关键字匹配**: 物品lore中的套装关键字必须与配置文件完全匹配
2. **属性格式**: 所有属性效果格式必须符合SX-Attribute插件要求
3. **配置重载**: 修改配置文件后需要重载插件才能生效
4. **测试验证**: 建议在测试服务器上充分测试后再部署到正式服务器

### 🎯 性能优化
1. **合理配置**: 避免过多的套装配置影响服务器性能
2. **适量监听**: 插件已优化事件监听，减少不必要的计算
3. **延迟更新**: 使用1tick延迟确保操作完成后再更新状态

## ❓ 常见问题

### 🛠️ 故障排除

**Q: 套装效果不生效怎么办？**
A: 请检查以下几点：
- ✅ 确认物品lore中的关键字与配置文件完全匹配
- ✅ 确认属性格式符合SX-Attribute要求
- ✅ 检查是否装备了足够件数的套装
- ✅ 确认SX-Attribute插件正常运行

**Q: LORE状态不更新怎么办？**
A: 可能的解决方案：
- 🔄 重新装备一次套装物品
- 🔄 使用 `/reload` 重载插件
- 🔍 检查控制台是否有错误信息
- 🔍 确认物品lore格式正确

**Q: 可以同时装备多个套装吗？**
A: ✅ 可以！不同套装的效果会同时生效，状态也会分别显示

**Q: 如何修改套装效果？**
A: 📝 直接修改 `sets/` 目录下的配置文件，然后重载插件即可

**Q: 支持自定义件数的套装吗？**
A: ✅ 完全支持！可以配置2件套、3件套、5件套等任意件数

## 🏗️ 技术架构

### 📦 核心组件

#### 主类结构
- **SXSet.java**: 插件主类，负责生命周期管理和依赖检查
- **SetData.java**: 套装数据模型，存储套装配置信息
- **SetManager.java**: 套装管理器，处理套装逻辑和LORE更新
- **SetListener.java**: 事件监听器，响应玩家操作和属性更新

#### 设计模式
- **单例模式**: SetManager使用单例模式确保全局唯一实例
- **观察者模式**: 通过事件监听实现装备变化的实时响应
- **策略模式**: 支持不同类型套装的灵活配置和处理

### 🔧 API集成

#### SX-Attribute集成
- **属性系统**: 完全兼容SX-Attribute的属性格式和API
- **事件监听**: 监听SXGetAttributeEvent实现属性注入
- **数据处理**: 使用SXAttributeData进行属性数据管理

#### Bukkit/Paper API
- **事件系统**: 利用Bukkit事件系统监听玩家操作
- **物品管理**: 通过ItemStack和ItemMeta处理物品数据
- **配置系统**: 使用YamlConfiguration处理配置文件
